<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime Details</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
</head>
<body>
    <h1 id="anime-name"></h1>
    <img id="anime-image" alt="Anime Image" style="max-width: 300px; border-radius: 10px;">
    <p id="anime-description"></p>
    <ul id="episode-links"></ul>

    <script>
        const encryptionKey = 'd3f9a1c4b8e2f6c3a7b5d6e4f2c8a9d0d3f9a1c4b8e2f6c3a7b5d6e4f2c8a9d0';

        function decrypt(encryptedText) {
            const [ivHex, encryptedHex] = encryptedText.split(':');
            const iv = CryptoJS.enc.Hex.parse(ivHex);
            const encrypted = CryptoJS.enc.Hex.parse(encryptedHex);

            const decrypted = CryptoJS.AES.decrypt(
                { ciphertext: encrypted },
                CryptoJS.enc.Hex.parse(encryptionKey),
                { iv: iv }
            );

            return decrypted.toString(CryptoJS.enc.Utf8);
        }

        function parseQuery(queryString) {
            const params = new URLSearchParams(queryString);
            const data = params.get('q');
            if (!data) {
                document.body.innerHTML = '<h1>Invalid Link</h1>';
                return null;
            }
            const decryptedQuery = decrypt(data);
            return new URLSearchParams(decryptedQuery);
        }

        function displayAnimeData(queryParams) {
            if (!queryParams) return;

            document.getElementById('anime-name').textContent = queryParams.get('Anime');
            document.getElementById('anime-image').src = queryParams.get('Image');
            document.getElementById('anime-description').textContent = queryParams.get('Description');

            const episodesList = document.getElementById('episode-links');
            queryParams.forEach((value, key) => {
                if (key.startsWith('ep')) {
                    const listItem = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = value;
                    link.textContent = `Watch Episode ${key.replace('ep', '')}`;
                    listItem.appendChild(link);
                    episodesList.appendChild(listItem);
                }
            });
        }

        function init() {
            const decryptedParams = parseQuery(window.location.search.substring(1));
            if (decryptedParams) {
                displayAnimeData(decryptedParams);
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }

        init();
    </script>
</body>
</html>
